$("#previewSKE").on("click",function(e){var rowCount=$("#countSigner .row").length;var idForm=$("#SuratKeluarEksternal textarea").map(function(){req=$(this).is("[required]");if(req){return this.id}}).get();var ix;for(ix=0;ix<idForm.length;++ix){var jenis_surat=$("#"+idForm[ix]).val();if(jenis_surat==""){var label=$("#"+idForm[ix]).attr("data-label");$("#"+idForm[ix]).removeClass("form-control").addClass("form-control is-invalid");return alert(label+" Tidak Boleh Kosong")}}
var i;for(i=0;i<rowCount;++i){var jenis_surat=$("select[id=signer"+i+"]").val();if(jenis_surat==""){return alert("Signer Tidak Boleh Kosong")}}
var arrays=[];$(".selectdarkReceiver").each(function(){arrays.push($(this).val())});var arrayst=[];$(".selectdarkTindasan").each(function(){arrayst.push($(this).val())});var arrayssig=[];$(".selectdarkSigner").each(function(){arrayssig.push($(this).val())});var arraysr=[];$("#tabRefrensi li").each(function(){arraysr.push($(this).data("val"));arraysr.push($(this).data("jenissurat"))});var url=urlSKE;var id=idSKE;var data_type=data_typeSKE;var jenis_surat=$("input[id=jenis_surat]").val();var detailSigner=arrayssig;var dari=dariSKE;var lampiran=$("input[id=lampiran]").val();var jenis_prior=$("select[id=jenis_prior]").val();var kerahasiaan_surat=$("select[id=kerahasiaan_surat]").val();var txt_perihal=$("textarea[id=txt_perihal]").val();var surat=CKEDITOR.instances.editor.getData();var setPageHeader=$("#setPageHeader").is(":checked")?1:0;var setPageFooter=$("#setPageFooter").is(":checked")?1:0;var urlPDF=urlPDFSKE;$.ajax({url:url,type:"POST",data:{id:id,data_type:data_type,kepadaArr:arrays,melaluiArr:"",refrensiArr:arraysr.length!=0?chunkArrayLoop(arraysr,2):"",tindasanArr:arrayst.length!=0?arrayst:"",jenis_surat:jenis_surat,detail_signer:detailSigner,dari:dari,lampiran:lampiran?lampiran:"",jenis_prior:jenis_prior,tanggal_surat:"",kerahasiaan_surat:kerahasiaan_surat,txt_perihal:txt_perihal,kepada:"",tempat:"",surat:surat,setPageHeader:setPageHeader,setPageFooter:setPageFooter,},success:function(data){$("#previewPDF").html('<iframe width="100%" height="700" src='+urlPDF+' title="PDF Result" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');$("#previewModalPdf").modal("show")},})});function chunkArrayLoop(array,size){let result=[];for(let i=0;i<array.length;i+=size){let chunk=[];for(let j=i;j<i+size&&j<array.length;j++){chunk.push(array[j])}
result.push(chunk)}
return result}
$("#btnBtnCloseModalSKE").on("click",function(e){$.ajax({type:"POST",url:"showPreview/closed",success:function(result){console.log(result)},});e.preventDefault()});$("#saveDraftSuratSKE").on("click",function(e){$.ajax({type:"POST",url:"saveDraftSurat",success:function(result){Swal.fire({title:"Auto close alert!",html:"I will close in <strong></strong> draft seconds.",timer:1000,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){window.location.href=urlsaveDraftSuratSKE}})},});e.preventDefault()});$("#updateDraftSuratSKE").on("click",function(e){var id=idSKE;$.ajax({type:"POST",url:urlupdateDraftSuratSKE1,data:{ids:id,},success:function(result){Swal.fire({title:"Auto close alert!",html:"I will close in <strong></strong> draft seconds.",timer:1000,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){window.location.href=urlupdateDraftSuratSKE2}})},})});$("#submitSaveNoDinAntarDivBagSKE").on("click",function(e){if(document.readyState=="complete"){Swal.fire({title:"Apakah Yakin",text:"Telah Membuat Surat ini Dengan Benar!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Kirim",}).then((result)=>{if(result.value){Swal.fire({title:"MEMPROSES",html:"Mengirim Notifikasi..!",allowOutsideClick:!1,showConfirmButton:!1,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){}});$("#SuratKeluarEksternal").submit()}})}});$("#submitSaveSuratMasuk").on("click",function(e){var idForm=$("#SuratMasuk textarea, input").map(function(){req=$(this).is("[required]");if(req){return this.id}}).get();var ix;for(ix=0;ix<idForm.length;++ix){var jenis_surat=$("#"+idForm[ix]).val();if(jenis_surat==""){var label=$("#"+idForm[ix]).attr("data-label");$("#"+idForm[ix]).removeClass("form-control").addClass("form-control is-invalid");return alert(label+" Tidak Boleh Kosong")}}
if(document.readyState=="complete"){Swal.fire({title:"Apakah Yakin",text:"Telah Membuat Surat ini Dengan Benar!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Kirim",}).then((result)=>{if(result.value){Swal.fire({title:"MEMPROSES",html:"Mengirim Notifikasi..!",allowOutsideClick:!1,showConfirmButton:!1,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){}});$("#SuratMasuk").submit()}})}});$(document).on("click","#syncronizeSKE",function(e){$.ajax({type:"POST",url:urlsyncronizeSKE,cache:!1,delay:800,success:function(data){$("#receiver0").html(data)},})});$("#tambahHapusBtnTindasanSKE").on("click",function(e){var rowCount=$("#countTindasan .row").length;var html="";html+='<div class="row">';html+='<div class="col-sm-3">';html+='<div class="form-group">';html+='<select class="form-control selectdarkTindasan" id="tindasan-kategori" name="tindasan[0][]" aria-label="Default select example" data-sub_kategori="0">';html+='<option value="direksi">DIREKSI</option>';html+='<option value="divisi">DIVISI</option>';html+='<option value="pekerja">PEKERJA</option>';html+='<option value="cabang">UNIT KERJA</option>';html+='<option value="eksternal">EKSTERNAL</option>';html+="</select>";html+="</div>";html+="</div>";html+='<div class="col-sm-6">';html+='<div class="form-group">';html+='<select class="select2 selectdarkTindasan" id="tindasan0" name="tindasan[0][]" aria-label="Default select example" style="width: 100%; height: 200px;">';html+='"'+dataDireksiTindasan+'"';html+="</select>";html+="</div>";html+="</div>";html+='<div class="col-sm-2">';html+='<div class="form-group">';html+='<span id="spanBtnEksternalSKE0"></span>';html+='<button class="btn btn-success" type="button" onclick="sub_tindasan();"><i class="fa fa-plus"></i></button>';html+="</div>";html+="</div>";html+="</div>";html+='</div> <div id="subTindasan" class="m-t-20"></div>';$("#countTindasan").append(html);$("#tindasan0").select2();if(rowCount!=0){$("#countTindasan").replaceWith('<div class="ml-2 mt-2" id="countTindasan"></div>');$("#tambahHapusBtnTindasanSKE").html("Tambah")}else{$("#tambahHapusBtnTindasanSKE").html("Hapus")}});$("#previewND").on("click",function(e){var rowCount=$("#countSigner .row").length;var idForm=$("#SuratNodinAntarDivBag textarea, input").map(function(){req=$(this).is("[required]");if(req){return this.id}}).get();var ix;for(ix=0;ix<idForm.length;++ix){var jenis_surat=$("#"+idForm[ix]).val();if(jenis_surat==""){var label=$("#"+idForm[ix]).attr("data-label");$("#"+idForm[ix]).removeClass("form-control").addClass("form-control is-invalid");return alert(label+" Tidak Boleh Kosong")}}
var i;for(i=0;i<rowCount;++i){var jenis_surat=$("select[id=receiver"+i+"]").val();if(jenis_surat=="0"){return alert("Receiver Tidak Boleh Kosong")}}
var arrays=[];$(".selectdarkReceiver").each(function(){arrays.push($(this).val())});var arrayst=[];$(".selectdarkTindasan").each(function(){arrayst.push($(this).val())});var arraysr=[];$("#tabRefrensi li").each(function(){arraysr.push($(this).data("val"));arraysr.push($(this).data("jenissurat"))});var arrayssig=[];$(".selectdarkSigner").each(function(){arrayssig.push($(this).val())});var url=urlND;var id=idND;var data_type=data_typeND;var jenis_surat=$("input[id=jenis_surat]").val();var detailSigner=arrayssig;var dari=dariND;var lampiran=$("input[id=lampiran]").val();var jenis_prior=$("select[id=jenis_prior]").val();var kerahasiaan_surat=$("select[id=kerahasiaan_surat]").val();var txt_perihal=$("textarea[id=txt_perihal]").val();var surat=CKEDITOR.instances.editor.getData();var setPageHeader=$("#setPageHeader").is(":checked")?1:0;var setPageFooter=$("#setPageFooter").is(":checked")?1:0;var urlPDF=urlPDFND;$.ajax({url:url,type:"POST",data:{id:id,data_type:data_type,kepadaArr:arrays,melaluiArr:"",refrensiArr:arraysr.length!=0?chunkArrayLoop(arraysr,2):"",tindasanArr:arrayst.length!=0?arrayst:"",jenis_surat:jenis_surat,detail_signer:detailSigner,dari:dari,lampiran:lampiran?lampiran:"",jenis_prior:jenis_prior,tanggal_surat:"",kerahasiaan_surat:kerahasiaan_surat,txt_perihal:txt_perihal,kepada:"",tempat:"",surat:surat,setPageHeader:setPageHeader,setPageFooter:setPageFooter,},success:function(data){$("#previewPDF").html('<iframe width="100%" height="700" src='+urlPDF+' title="PDF Result" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');$("#previewModalPdf").modal("show")},})});$("#btnBtnCloseModalND").on("click",function(e){$.ajax({type:"POST",url:"showPreview/closed",success:function(result){console.log(result)},});e.preventDefault()});$("#saveDraftSuratND").on("click",function(e){$.ajax({type:"POST",url:"saveDraftSurat",success:function(result){console.log(result);Swal.fire({title:"Auto close alert!",html:"I will close in <strong></strong> draft seconds.",timer:1000,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){window.location.href=urlsaveDraftSuratND}})},});e.preventDefault()});$("#updateDraftSuratND").on("click",function(e){var id=idND;$.ajax({type:"POST",url:urlupdateDraftSuratND1,data:{ids:id,},success:function(result){Swal.fire({title:"Auto close alert!",html:"I will close in <strong></strong> draft seconds.",timer:1000,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){window.location.href=urlupdateDraftSuratND2}})},})});$("#submitSaveNoDinAntarDivBagND").click(function(e){if(document.readyState=="complete"){Swal.fire({title:"Apakah Yakin",text:"Telah Membuat Surat ini Dengan Benar!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Kirim",}).then((result)=>{if(result.value){Swal.fire({title:"MEMPROSES",html:"Mengirim Notifikasi..!",allowOutsideClick:!1,showConfirmButton:!1,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){}});$("#SuratNodinAntarDivBag").submit()}})}});$("#tambahHapusBtnTindasanND").on("click",function(e){var rowCount=$("#countTindasan .row").length;console.log(rowCount);var html="";html+='<div class="row">';html+='<div class="col-sm-3">';html+='<div class="form-group">';html+='<select class="form-control selectdarkTindasan" id="tindasan-kategori" name="tindasan[0][]" aria-label="Default select example" data-sub_kategori="0">';html+='<option value="direksi">DIREKSI</option>';html+='<option value="divisi">DIVISI</option>';html+='<option value="bagian">BAGIAN</option>';html+='<option value="pekerja">PEKERJA</option>';html+='<option value="cabang">UNIT KERJA</option>';html+="</select>";html+="</div>";html+="</div>";html+='<div class="col-sm-6">';html+='<div class="form-group">';html+='<select class="select2 selectdarkTindasan" id="tindasan0" name="tindasan[0][]" aria-label="Default select example" style="width: 100%; height: 200px;">';html+='"'+dataDireksiTindasan+'"';html+="</select>";html+="</div>";html+="</div>";html+='<div class="col-sm-2">';html+='<div class="form-group">';html+='<button class="btn btn-success" type="button" onclick="sub_tindasan();"><i class="fa fa-plus"></i></button>';html+="</div>";html+="</div>";html+="</div>";html+='</div> <div id="subTindasan" class="m-t-20"></div>';$("#countTindasan").append(html);$("#tindasan0").select2();if(rowCount!=0){$("#countTindasan").replaceWith('<div class="ml-2 mt-2" id="countTindasan"></div>');$("#tambahHapusBtnTindasanND").html("Tambah")}else{$("#tambahHapusBtnTindasanND").html("Hapus")}});$("#previewNDIP").on("click",function(e){$("#loader, #loader2, #loader3").css("display","block");var rowCountBagian=$("#data_bagian").length;var rowCount=$("#countSigner .row").length;var data_bagian=$("select[id=data_bagian]").val();var idForm=$("#SuratNodinIjinPrinsip textarea, input").map(function(){req=$(this).is("[required]");if(req){return this.id}}).get();var ix;for(ix=0;ix<idForm.length;++ix){var jenis_surat=$("#"+idForm[ix]).val();if(jenis_surat==""){var label=$("#"+idForm[ix]).attr("data-label");$("#"+idForm[ix]).removeClass("form-control").addClass("form-control is-invalid");return alert(label+" Tidak Boleh Kosong")}}
var i;for(i=0;i<rowCount;++i){var jenis_surat=$("select[id=signer"+i+"]").val();if(jenis_surat==""){return alert("Signer Tidak Boleh Kosong")}}
if(rowCountBagian>0){if(data_bagian==0){alert("Dari Tidak Boleh Kosong");return setTimeout(showPage,1000)}}
var arrays=[];$(".selectdarkReceiver").each(function(){arrays.push($(this).val())});var arrayst=[];$(".selectdarkTindasan").each(function(){arrayst.push($(this).val())});var arraysm=[];$(".selectdarkMelalui").each(function(){arraysm.push($(this).val())});var arraysr=[];$("#tabRefrensi li").each(function(){arraysr.push($(this).data("val"));arraysr.push($(this).data("jenissurat"))});var url=urlNDIP;var id=idNDIP;var data_type=data_typeNDIP;var jenis_surat=$("input[id=jenis_surat]").val();var detailSigner=$("select[id=signer0]").val();var dari=rowCountBagian!=0?data_bagian:dariNDIP;var lampiran=$("input[id=lampiran]").val();var jenis_prior=$("select[id=jenis_prior]").val();var kerahasiaan_surat=$("select[id=kerahasiaan_surat]").val();var txt_perihal=$("textarea[id=txt_perihal]").val();var surat=CKEDITOR.instances.editor.getData();var setPageHeader=$("#setPageHeader").is(":checked")?1:0;var setPageFooter=$("#setPageFooter").is(":checked")?1:0;$.ajax({url:url,type:"POST",data:{id:id,data_type:data_type,kepadaArr:arrays,melaluiArr:arraysm.length!=0?arraysm:"",refrensiArr:arraysr.length!=0?chunkArrayLoop(arraysr,2):"",tindasanArr:arrayst.length!=0?arrayst:"",jenis_surat:jenis_surat,detail_signer:detailSigner,dari:dari,lampiran:lampiran?lampiran:"",jenis_prior:jenis_prior,kerahasiaan_surat:kerahasiaan_surat,txt_perihal:txt_perihal,surat:surat,setPageHeader:setPageHeader,setPageFooter:setPageFooter,},success:function(data){$("#previewPDF").html('<iframe width="100%" height="700" src='+urlPDFNDIP+' title="PDF Result" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');$("#previewModalPdf").modal("show");return setTimeout(showPage,100)},})});$("#btnBtnCloseModalNDIP").on("click",function(e){$.ajax({type:"POST",url:"showPreview/closed",success:function(result){console.log(result)},});e.preventDefault()});$("#saveDraftSuratNDIP").on("click",function(e){$.ajax({type:"POST",url:"saveDraftSurat",success:function(result){console.log(result);Swal.fire({title:"Auto close alert!",html:"I will close in <strong></strong> draft seconds.",timer:1000,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){window.location.href=urlsaveDraftSuratNDIP}})},});e.preventDefault()});$("#updateDraftSuratNDIP").on("click",function(e){var id=idNDIP;$.ajax({type:"POST",url:urlupdateDraftSuratNDIP1,data:{ids:id,},success:function(result){Swal.fire({title:"Auto close alert!",html:"I will close in <strong></strong> draft seconds.",timer:1000,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){window.location.href=urlupdateDraftSuratNDIP2}})},})});$("#submitSaveNoDinAntarDivBagNDIP").on("click",function(e){if(document.readyState=="complete"){Swal.fire({title:"Apakah Yakin",text:"Telah Membuat Surat ini Dengan Benar!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Kirim",}).then((result)=>{if(result.value){Swal.fire({title:"MEMPROSES",html:"Mengirim Notifikasi..!",allowOutsideClick:!1,showConfirmButton:!1,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){}});$("#SuratNodinIjinPrinsip").submit()}})}});$("#tambahHapusBtnTindasanNDIP").on("click",function(e){var rowCount=$("#countTindasan .row").length;var html="";html+='<div class="row">';html+='<div class="col-sm-3">';html+='<div class="form-group">';html+='<select class="form-control selectdarkTindasan" id="tindasan-kategori" name="tindasan[0][]" aria-label="Default select example" data-sub_kategori="0">';html+='<option value="direksi">DIREKSI</option>';html+='<option value="divisi">DIVISI</option>';html+='<option value="bagian">BAGIAN</option>';html+='<option value="pekerja">PEKERJA</option>';html+='<option value="cabang">UNIT KERJA</option>';html+="</select>";html+="</div>";html+="</div>";html+='<div class="col-sm-6">';html+='<div class="form-group">';html+='<select class="select2 selectdarkTindasan" id="tindasan0" name="tindasan[0][]" aria-label="Default select example" style="width: 100%; height: 200px;">';html+='"'+dataDireksiTindasan+'"';html+="</select>";html+="</div>";html+="</div>";html+='<div class="col-sm-2">';html+='<div class="form-group">';html+='<button class="btn btn-success" type="button" onclick="sub_tindasan();"><i class="fa fa-plus"></i></button>';html+="</div>";html+="</div>";html+="</div>";html+='</div> <div id="subTindasan" class="m-t-20"></div>';$("#countTindasan").append(html);$("#tindasan0").select2();if(rowCount!=0){$("#countTindasan").replaceWith('<div class="ml-2 mt-2" id="countTindasan"></div>');$("#tambahHapusBtnTindasanNDIP").html("Tambah")}else{$("#tambahHapusBtnTindasanNDIP").html("Hapus")}});$("#tambahHapusBtnTindasanCabangNDIP").on("click",function(e){var rowCount=$("#countTindasan .row").length;var html="";html+='<div class="row">';html+='<div class="col-sm-3">';html+='<div class="form-group">';html+='<select class="form-control selectdarkTindasan" id="tindasan-kategori" name="tindasan[0][]" aria-label="Default select example" data-sub_kategori="0">';html+='<option value="pekerja">PEKERJA</option>';html+="</select>";html+="</div>";html+="</div>";html+='<div class="col-sm-6">';html+='<div class="form-group">';html+='<select class="select2 selectdarkTindasan" id="tindasan0" name="tindasan[0][]" aria-label="Default select example" style="width: 100%; height: 200px;">';html+='"'+listUserCabang+'"';html+="</select>";html+="</div>";html+="</div>";html+='<div class="col-sm-2">';html+='<div class="form-group">';html+='<button class="btn btn-success" type="button" onclick="sub_tindasanCabang();"><i class="fa fa-plus"></i></button>';html+="</div>";html+="</div>";html+="</div>";html+='</div> <div id="subTindasan" class="m-t-20"></div>';$("#countTindasan").append(html);$("#tindasan0").select2();if(rowCount!=0){$("#countTindasan").replaceWith('<div class="ml-2 mt-2" id="countTindasan"></div>');$("#tambahHapusBtnTindasanCabangNDIP").html("Tambah")}else{$("#tambahHapusBtnTindasanCabangNDIP").html("Hapus")}});$("#previewSKI").on("click",function(e){$("#loader, #loader2, #loader3").css("display","block");var rowCount=$("#countSigner .row").length;var idForm=$("#SuratKeluarInternal textarea, input").map(function(){req=$(this).is("[required]");if(req){return this.id}}).get();var ix;for(ix=0;ix<idForm.length;++ix){var jenis_surat=$("#"+idForm[ix]).val();if(jenis_surat==""){var label=$("#"+idForm[ix]).attr("data-label");$("#"+idForm[ix]).removeClass("form-control").addClass("form-control is-invalid");alert(label+" Tidak Boleh Kosong");return setTimeout(showPage,200)}}
var i;for(i=0;i<rowCount;++i){var jenis_surat=$("select[id=signer"+i+"]").val();if(jenis_surat==""){alert("Signer Tidak Boleh Kosong");return setTimeout(showPage,200)}}
var arrays=[];$(".selectdarkReceiver").each(function(){arrays.push($(this).val())});var arraysAll=arrays[1];var arrayst=[];$(".selectdarkTindasan").each(function(){arrayst.push($(this).val())});var arrayssig=[];$(".selectdarkSigner").each(function(){arrayssig.push($(this).val())});var arraysr=[];$("#tabRefrensi li").each(function(){arraysr.push($(this).data("val"));arraysr.push($(this).data("jenissurat"))});var numP=0;var numB=0;for(var i=0;i<arrays.length;i++){if(arrays[i]=="AllPinca"){numP+=1}else if(arrays[i]=="AllBm"){numB+=1}}
if(numP>0&&numB>0){alert("Pilih -- Semua Pinca & BM -- Jika ingin mengirim ke seluruh Unit Kerja");return setTimeout(showPage,200)}else if(numP>1){alert("Tidak dapat Memilih -- Semua Pemimpin Cabang -- Dua Kali");return setTimeout(showPage,200)}else if(numB>1){alert("Tidak dapat Memilih -- Semua Building manager -- Dua Kali");return setTimeout(showPage,200)}
if((arraysAll=="All"&&arrays.length>2)||(arraysAll=="AllPinca"&&arraysAll=="AllBm")){alert("-- Semua .... -- Tidak Dapat Digabung Dengan Penerima Lain");return setTimeout(showPage,200)}
var url=urlSKI;var id=idSKI;var data_type=data_typeSKI;var jenis_surat=$("input[id=jenis_surat]").val();var detailSigner=arrayssig;var dari=dariSKI;var lampiran=$("input[id=lampiran]").val();var jenis_prior=$("select[id=jenis_prior]").val();var kerahasiaan_surat=$("select[id=kerahasiaan_surat]").val();var txt_perihal=$("textarea[id=txt_perihal]").val();var surat=CKEDITOR.instances.editor.getData();var setPageHeader=$("#setPageHeader").is(":checked")?1:0;var setPageFooter=$("#setPageFooter").is(":checked")?1:0;$.ajax({url:url,type:"POST",data:{id:id,data_type:data_type,kepadaArr:arrays,melaluiArr:"",refrensiArr:arraysr.length!=0?chunkArrayLoop(arraysr,2):"",tindasanArr:arrayst.length!=0?arrayst:"",jenis_surat:jenis_surat,detail_signer:detailSigner,dari:dari,lampiran:lampiran?lampiran:"",jenis_prior:jenis_prior,tanggal_surat:"",kerahasiaan_surat:kerahasiaan_surat,txt_perihal:txt_perihal,kepada:"",tempat:"",surat:surat,setPageHeader:setPageHeader,setPageFooter:setPageFooter,},success:function(data){$("#previewPDF").html('<iframe width="100%" height="700" src='+urlPDFSKI+' title="PDF Result" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');$("#previewModalPdf").modal("show");return setTimeout(showPage,100)},})});$("#btnBtnCloseModalSKI").on("click",function(e){$.ajax({type:"POST",url:"showPreview/closed",success:function(result){console.log("btnBtnCloseModalSKI")},});e.preventDefault()});$("#saveDraftSuratSKI").on("click",function(e){$.ajax({type:"POST",url:"saveDraftSurat",success:function(result){console.log(result);Swal.fire({title:"Auto close alert!",html:"I will close in <strong></strong> draft seconds.",timer:1000,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){window.location.href=urlsaveDraftSuratSKI}})},});e.preventDefault()});$("#updateDraftSuratSKI").on("click",function(e){var id=idSKI;$.ajax({type:"POST",url:urlupdateDraftSuratSKI1,data:{ids:id,},success:function(result){Swal.fire({title:"Auto close alert!",html:"I will close in <strong></strong> draft seconds.",timer:1000,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){window.location.href=urlupdateDraftSuratSKI2}})},})});$("#submitSaveNoDinAntarDivBagSKI").on("click",function(e){if(document.readyState=="complete"){Swal.fire({title:"Apakah Yakin",text:"Telah Membuat Surat ini Dengan Benar!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Kirim",}).then((result)=>{if(result.value){Swal.fire({title:"MEMPROSES",html:"Mengirim Notifikasi..!",allowOutsideClick:!1,showConfirmButton:!1,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){}});$("#SuratKeluarInternal").submit()}})}});$("#tambahHapusBtnTindasanSKI").on("click",function(e){var rowCount=$("#countTindasan .row").length;var html="";html+='<div class="row">';html+='<div class="col-sm-3">';html+='<div class="form-group">';html+='<select class="form-control selectdarkTindasan" id="tindasan-kategori" name="tindasan[0][]" aria-label="Default select example" data-sub_kategori="0">';html+='<option value="direksi">DIREKSI</option>';html+='<option value="divisi">DIVISI</option>';html+='<option value="bagian">BAGIAN</option>';html+='<option value="pekerja">PEKERJA</option>';html+='<option value="cabang">UNIT KERJA</option>';html+="</select>";html+="</div>";html+="</div>";html+='<div class="col-sm-6">';html+='<div class="form-group">';html+='<select class="select2 selectdarkTindasan" id="tindasan0" name="tindasan[0][]" aria-label="Default select example" style="width: 100%; height: 200px;">';html+='"'+dataDireksiTindasan+'"';html+="</select>";html+="</div>";html+="</div>";html+='<div class="col-sm-2">';html+='<div class="form-group">';html+='<button class="btn btn-success" type="button" onclick="sub_tindasan();"><i class="fa fa-plus"></i></button>';html+="</div>";html+="</div>";html+="</div>";html+='</div> <div id="subTindasan" class="m-t-20"></div>';$("#countTindasan").append(html);$("#tindasan0").select2();if(rowCount!=0){$("#countTindasan").replaceWith('<div class="ml-2 mt-2" id="countTindasan"></div>');$("#tambahHapusBtnTindasanSKI").html("Tambah")}else{$("#tambahHapusBtnTindasanSKI").html("Hapus")}});$("#previewEdit"+jenis_surat).on("click",function(e){$("#loader, #loader2, #loader3").css("display","block");var rowCount=$("#countSigner .row").length;var rowCountBagian=$("#data_bagian").length;var data_bagian=$("select[id=data_bagian]").val();var idForm=$("#SuratNodinIjinPrinsip textarea, input").map(function(){req=$(this).is("[required]");if(req){return this.id}}).get();var ix;for(ix=0;ix<idForm.length;++ix){var jenis_surat=$("#"+idForm[ix]).val();if(jenis_surat==""){var label=$("#"+idForm[ix]).attr("data-label");$("#"+idForm[ix]).removeClass("form-control").addClass("form-control is-invalid");alert(label+" Tidak Boleh Kosong");return setTimeout(showPage,200)}}
var i;for(i=0;i<rowCount;++i){var jenis_surat=$("select[id=signer"+i+"]").val();if(jenis_surat==""){alert("Signer Tidak Boleh Kosong");return setTimeout(showPage,200)}}
var iy;for(iy=0;iy<rowCount;++iy){var jenis_surat=$("#SuratNodinAntarDivBag select[id=receiver"+iy+"]").val();if(jenis_surat=="0"){alert("Penerima Tidak Boleh Kosong");return setTimeout(showPage,200)}}
if(rowCountBagian>0){if(data_bagian==0){return alert("Dari Tidak Boleh Kosong")}}
var arrays=[];$(".selectdarkReceiver").each(function(){arrays.push($(this).val())});var arraysAll=arrays[1];var arrayst=[];$(".selectdarkTindasan").each(function(){arrayst.push($(this).val())});var arraysm=[];$(".selectdarkMelalui").each(function(){arraysm.push($(this).val())});var arrayssig=[];$(".selectdarkSigner").each(function(){arrayssig.push($(this).val())});var arraysr=[];$("#tabRefrensi li").each(function(){arraysr.push($(this).data("val"));arraysr.push($(this).data("jenissurat"))});if(arraysAll=="All"&&arrays.length>2){alert("Penerima --Semua-- Tidak Bisa Digabung Dengan Penerima Lain");return setTimeout(showPage,200)}
var url=urlEdit;var id=idEdit;var data_type=data_typeEdit;var jenis_surat=$("input[id=jenis_surat]").val();var detailSigner=jenis_surat=="SKE"||jenis_surat=="SKI"||jenis_surat=="ND"?arrayssig:$("select[id=signer0]").val();var dari=rowCountBagian!=0?data_bagian:dariEdit;var lampiran=$("input[id=lampiran]").val();var jenis_prior=$("select[id=jenis_prior]").val();var kerahasiaan_surat=$("select[id=kerahasiaan_surat]").val();var txt_perihal=$("textarea[id=txt_perihal]").val();var surat=CKEDITOR.instances.editor.getData();var setPageHeader=$("#setPageHeader").is(":checked")?1:0;var setPageFooter=$("#setPageFooter").is(":checked")?1:0;var urlPDFEditShow=urlPDFEdit;$.ajax({url:url,type:"POST",data:{id:id,data_type:data_type,kepadaArr:arrays,melaluiArr:arraysm.length!=0?arraysm:"",refrensiArr:arraysr.length!=0?chunkArrayLoop(arraysr,2):"",tindasanArr:arrayst.length!=0?arrayst:"",jenis_surat:jenis_surat,detail_signer:detailSigner,dari:dari,lampiran:lampiran?lampiran:"",jenis_prior:jenis_prior,tanggal_surat:"",kerahasiaan_surat:kerahasiaan_surat,txt_perihal:txt_perihal,surat:surat,setPageHeader:setPageHeader,setPageFooter:setPageFooter,},success:function(data){$("#previewPDF").html('<iframe width="100%" height="700" src='+urlPDFEditShow+' title="PDF Result" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');$("#previewModalPdf").modal("show");return setTimeout(showPage,100)},})});$("#btnBtnCloseModalEdit").on("click",function(e){$.ajax({type:"POST",url:"../showPreview/closed",success:function(result){console.log("closed")},});e.preventDefault()});$("#updateDraftSuratEdit").on("click",function(e){var id=idEdit;$.ajax({type:"POST",url:urlupdateDraftSuratEdit1,data:{ids:id,},success:function(result){Swal.fire({title:"Auto close alert!",html:"I will close in <strong></strong> draft seconds.",timer:1000,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){window.location.href=urlupdateDraftSuratEdit2}})},})});$("#submitSaveNoDinAntarDivBag"+jenis_surat).on("click",function(e){var text;if(document.readyState=="complete"){Swal.fire({title:"Apakah Yakin",text:"Telah Membuat Surat ini Dengan Benar!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Kirim",}).then((result)=>{if(result.value){Swal.fire({title:"MEMPROSES",html:"Mengirim Notifikasi..!",allowOutsideClick:!1,showConfirmButton:!1,}).then((result)=>{if(result.dismiss===Swal.DismissReason.timer){}});switch(jenis_surat){case "SKI":values="#SuratKeluarInternal";break;case "SKE":values="#SuratKeluarEksternal";break;case "ND":values="#SuratNodinAntarDivBag";break;case "NDIP":values="#SuratNodinIjinPrinsip";break}
$(values).submit()}})}})
